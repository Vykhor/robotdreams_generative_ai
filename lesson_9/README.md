
# Проєкт відновлення зображень за допомогою GAN

Цей репозиторій містить набір Python-скриптів для побудови, навчання та оцінки моделі генеративних змагальних мереж (GAN) для відновлення пошкоджених зображень. Проєкт включає етапи підготовки даних, створення моделей генератора і дискримінатора та використання їх для відновлення зображень.

---

## Особливості

- **Генератор**: Використання багатошарового перцептрону для генерації зображень MNIST на основі випадкових векторів.
- **Дискримінатор**: Використання багатошарового перцептрону для оцінки реальності згенерованих зображень.
- **Дані**: Завантаження та підготовка (пошкодження) даних для тренування мереж.
- **Збереження та завантаження моделі**: Збереження натренованого генератора та його подальше завантаження для оцінки та генерації відновлених зображень.
- **Оцінка генерації**: Генерація та візуалізація зображень за допомогою натренованого генератора.

---

## Опис скриптів

### 1. **`data/Dataset.py`**
Скрипт для підготовки даних:
- Завантаження даних `cifar10`.
- Перетворення даних в тензори і нормалізація.
- Збереження даних у форматі CSV для подальшого використання.

### 2. **`data/Corruption.py`**
Скрипт для пошкодження даних:
- Випадковим чином застосовує до кожного зображення з набору один з варіантів пошкодження.

### 3. **`data/Dataloader.py`**
Скрипт для завантаження даних з підготовленого файлу та перетворення їх у `DataLoader`:
- Завантажує дані зі збереженого файлу за вказаним шляхом.
- Перетворює дані у тензори та повертає об'єкт `DataLoader`.

### 4. **`model/Discriminator.py та model/Generator.py`**
Створення моделей дискримінатора GAN:
- Містить архітектуру моделей дискримінатора та генератора для задачі відновлення зображень.

### 5. **`plot/Plotter.py`**
Скрипт відповідає за побудову графіків для оцінки навчання моделі.

### 6. **`plot/Vizualization.py`**
- Відновлення пошкоджених зображень за допомогою попередньо натренованого генератора.
- Візуалізацію результатів роботи генератора у вигляді сітки з трьома рядками:
  1. Перший рядок — оригінальні зображення.
  2. Другий рядок — пошкоджені зображення.
  3. Третій рядок — відновлені зображення.

### 8. **`Metrics.py`**
Скрипт для розрахунку метрик PSNR та SSIM для оцінки якості відновлених зображень.

### 9. **`TrainingProcess.py`**
Скрипт для тренування GAN:
- Завантаження та підготовка даних з CSV файлів.
- Створення генератора та дискримінатора.
- Налаштування оптимізаторів, параметрів тренування та функцій втрат.
- Процес тренування з обчисленням втрат для генератора та дискримінатора.
- Збереження натренованого генератора після завершення навчання.

---

## Результати

- Після тренування моделі скрипт `TrainModel.py` зберігає натренований генератор у файл `result/mnist_generator.pth`.
- Скрипт `plot/Vizualization.py` дозволяє завантажити цей генератор і використовуати його для відновлення зображень.
- Приклад результату відновлення у файлі `result/vizualization.png`
- Візуалізація згенерованих зображень здійснюється у вигляді сітки з трьома рядками: оригінальні, пошкоджені та відновлені зображення.
- Лог навчання міститься у `results/log.txt`.
- Навчання відбувалось протягом 20 епох. Судячи з логу, на побудованих моделях можна було досягти кращих результатів збільшивши кількість епох, але це потребує значної кількості часу. 

---

## Використання

### 1. Підготовка датасету
Запустіть `data/PrepareDataset.py`, щоб завантажити та зберегти дані MNIST у форматі CSV:

```bash
python data/Dataset.py
```

### 2. Навчання моделі
Запустіть `TrainingProcess.py` для тренування моделі GAN:

```bash
python TrainingProcess.py
```

### 3. Завантаження і генерація зображень
Після тренування натреновану модель можна завантажити і використовувати для генерації нових зображень:

```bash
python plot/Visualization.py
```
---

## Попередні вимоги

- Python 3.8 або новіший.
- Бібліотеки:
  - `torch`
  - `torchvision`
  - `matplotlib`
  - `pandas`
  - `numpy`

Встановіть залежності за допомогою:

```bash
pip install torch torchvision matplotlib pandas numpy
```
