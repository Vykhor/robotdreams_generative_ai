
# Проєкт генерації зображень MNIST за допомогою просунутих GAN

Цей репозиторій містить набір Python-скриптів для побудови, навчання та оцінки моделі генеративних змагальних мереж (GAN) для генерації зображень, схожих на MNIST. Проєкт включає етапи підготовки даних, створення моделей генератора та дискримінатора, а також генерацію нових зображень з використанням натренованого генератора.

---

## Особливості

- **Дані MNIST**: Завантаження та підготовка даних MNIST для тренування мереж.
- **Збереження та завантаження моделі**: Збереження натренованого генератора та його подальше завантаження для оцінки та генерації зображень.
- **Оцінка генерації**: Генерація та візуалізація зображень за допомогою натренованого генератора.
- **Реалізація**: Реалізовано такі просунуті варіанти GAN як: `Deep Convolutional GAN`, `Wasserstein GAN`, `Conditional GAN`.  

---

## Опис структури проєкту

### 1. `common`
Містить скрипт `data/Dataset.py` для підготовки даних:
- Завантаження даних MNIST.
- Перетворення даних в тензори і нормалізація.
- Збереження даних у форматі CSV для подальшого використання.

Використовується для всіх моделей

### 3. `congan`, `dcgan`, `wgan`
Кожна з директорій містить набір скриптів, що реалізують відповідну просунуту генеративну змагальну мережу:
 - **congan** - `Conditional GAN`
 - **dcgan** - `Deep Convolutional GAN`
 - **wgan** - `Wasserstein GAN`

Кожна з директорій містить наступні скрипти:
#### 1. **`model/Discriminator.py та model/DiscriminatorWithMinibatch.py`**
Містить архітектуру дискримінатора та генератора відповідно.
#### 2. **`plot/Plotter.py`**
Функція для візуалізації згенерованих зображень:
- Генерація випадкових векторів для створення зображень.
- Візуалізація згенерованих зображень.
#### 3. **`plot/Vizualization.py`**
Скрипт для завантаження натренованого генератора та генерації зображень:
- Завантаження збереженого стану генератора.
- Генерація та візуалізація 16 зображень на основі випадкових векторів.
#### 4. **`TrainingProcess.py`**
Скрипт для тренування GAN:
- Завантаження та підготовка даних `MNIST` з CSV файлів.
- Створення генератора та дискримінатора.
- Налаштування оптимізаторів та параметрів тренування з використанням функції втрат
- Процес тренування з обчисленням втрат для генератора та дискримінатора.
- Кожні 10 епох виводяться приклади згенерованих зображень.
- Збереження натренованого генератора після завершення навчання.

---

## 3. Відмінності кожної просунутої моделі GAN від базової, що була реалізована у проєкті `lesson_6`:
### 1. **`Condition GAN`**
 - **Тренувальний процес**:
 - **Генератор**:
 - **Дисскримінатор**:
### 2. **`Deep Convolutional GAN`**
 - **Тренувальний процес**: без значних змін
 - **Генератор**: замість `Dense Layers` використано транспоновані згорткові шари (`ConvTranspose2d`), додано `Batch Normalization`.
 - **Дисскримінатор**: замість `Dense Layers` використано згорткові шари (`Conv2d), функція активації `ReLU` замінена на `LeakyReLU`.
### 3. **`Wasserstein GAN`**
(тут реалізовано `WGAN-GP`)
 - **Тренувальний процес**: 
   - Заміна функції втрат щоб використати Wasserstein-дистанцію замість крос-ентропії.
   - Додавання `Gradient Penalty` - штрафу на норму градієнта до функції втрат дискримінатора.
   - Виконується 5 ітерацій оновлення дискримінатора на 1 ітерацію оновлення генератора.
 - **Генератор**: без змін
 - **Дисскримінатор**: видалено шар `nn.Sigmoid()` так як  дискримінатор має повертати реальні значення, а недіапазон [0,1].

---

## Результати

- Після тренування моделі скрипт `TrainingProcess.py` зберігає натренований генератор у файл `mnist_generator.pth`.
- Скрипт `plot/Vizualization.py` дозволяє завантажити цей генератор і генерувати зображення, схожі на `MNIST`.
- Візуалізація згенерованих зображень здійснюється у вигляді сітки з 16 зображень.
 
---

## Використання

### 1. Підготовка датасету
Запустіть `common/data/PrepareDataset.py`, щоб завантажити та зберегти дані MNIST у форматі CSV:

```bash
python data/PrepareDataset.py
```

### 2. Навчання моделі
Запустіть `{gan_type}/TrainingProcess.py` для тренування моделі GAN де `{gan_type}` - тип моделі, яку потрібно навчити:

```bash
python TrainingProcess.py
```

### 3. Завантаження і генерація зображень
Після тренування натреновану модель можна завантажити і використовувати для генерації нових зображень:

```bash
python plot/Visualization.py
```
---

## Попередні вимоги

- Python 3.8 або новіший.
- Бібліотеки:
  - `torch`
  - `torchvision`
  - `matplotlib`
  - `pandas`
  - `numpy`

Встановіть залежності за допомогою:

```bash
pip install torch torchvision matplotlib pandas numpy
```
